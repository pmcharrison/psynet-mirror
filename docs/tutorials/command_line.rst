.. _command_line:

============
Command-line
============

.. warning::
    This section needs to be updated for PsyNet 10.0.0.

PsyNet is executed from the command line within the experiment directory.

Commands:

| :ref:`debug <debug>`
| :ref:`deploy <deploy>`
| :ref:`estimate <estimate>`
| :ref:`export <export>`
| :ref:`generate_constraints <generate-constraints>`
| :ref:`sandbox <sandbox>`
| :ref:`update <update>`

.. _debug:

Run an experiment locally (``debug``)
-------------------------------------

Start an experiment in debug mode with verbose output on localhost port 5000.

.. code:: bash

  psynet debug --verbose

**Usage**

.. code:: bash

  psynet debug [OPTIONS]

  Options:
    --verbose        Verbose mode
    --bot            Use bot to complete experiment
    --proxy TEXT     Alternate port when opening browser windows
    --no-browsers    Skip opening browsers
    --force-prepare  Force override of cache.
    --help           Show this message and exit.

.. _sandbox:

Sandbox an experiment (``sandbox``)
-----------------------------------

Deploy an experiment using Heroku to the MTurk Sandbox.

**Usage**

.. code:: bash

  psynet sandbox [OPTIONS]

  Options:
    --verbose        Verbose mode
    --app TEXT       Experiment id
    --archive TEXT   Optional path to an experiment archive
    --force-prepare  Force override of cache.
    --help           Show this message and exit.

.. _deploy:

Deploy an experiment (``deploy``)
---------------------------------

Deploy an experiment using Heroku to MTurk.

**Usage**

.. code:: bash

  psynet deploy [OPTIONS]

  Options:
    --verbose        Verbose mode
    --app TEXT       ID of the deployed experiment
    --archive TEXT   Optional path to an experiment archive
    --force-prepare  Force override of cache.
    --help           Show this message and exit.

.. _estimate:

Estimate maximum bonus and completion time (``estimate``)
---------------------------------------------------------

Estimate a participant's maximum bonus and time to complete the experiment.

.. code:: bash

  psynet estimate

**Usage**

.. code:: bash

  psynet estimate [OPTIONS]

  Options:
    --mode [bonus|time|both]  Type of result. Can be either 'bonus', 'time', or 'both'.
                              Default: 'both'.
    --help                    Show this message and exit.

.. _export:

Export data from an experiment (``export``)
-------------------------------------------

The data is exported in three distinct formats into the ``data/data-<APP_ID>``
directory of an experiment which has following structure:

::

  data/
  └── data-<app>/
      ├── csv/
      ├── db-snapshot/
      └── json/

csv:
    Contains the experiment data in CSV format.
db-snapshot:
    Contains the zip file generated by the default Dallinger export command.
json:
    Contains the experiment data in JSON format.

Local export
************

.. code:: bash

  psynet export --local --app APP_ID

.. note::
  Make sure you have an instance of PsyNet runnning on localhost port 5000.

                Show this message and exit.


Export from sandbox/production
******************************

.. code:: bash

  psynet export --app APP_ID

**Usage**

.. code:: bash

  psynet export [OPTIONS]

  Options:
    --verbose        Verbose mode
    --app TEXT       Experiment id
    --local          Export local data
    --force-prepare  Force override of cache.
    --help           Show this message and exit.


.. _update:

Generate the constraints.txt file (``generate-constraints``)
------------------------------------------------------------

Generate the constraints.txt file from requirements.txt.

.. code:: bash

  psynet generate-constraints

**Usage**

.. code:: bash

  psynet generate-constraints [OPTIONS]

  Options:
    --help                    Show this message and exit.


.. _update:

Update PsyNet/Dallinger (``update``)
------------------------------------

Update the local installations of `PsyNet` and `Dallinger` to their latest versions.
While the default is to update both packages, they can also be set to specific
versions (e.g. downgraded) using the ``--psynet-version`` and
``--dallinger-version`` command line options.

.. code:: bash

  psynet update

**Usage**

.. code:: bash

  psynet update [OPTIONS]

  Options:
    --dallinger-version TEXT  The git branch, commit or tag of the Dallinger
                              version to install.
    --psynet-version TEXT     The git branch, commit or tag of the psynet
                              version to install.
    --verbose                 Verbose mode
    --help                    Show this message and exit.



.. _rpdb:

Alias for rpdb using default port and IP (``rpdb``)
---------------------------------------------------------

Alias for nc using default port and IP. This is used for remote debugging. Insert `import rpdb; rpdb.set_trace()`
somewhere in your Python code, execute the program, and wait until it hits `rpdb.set_trace()`. Then you can enter the
interactive debugger by running `psynet rpdb` in a separate terminal.

.. code:: bash

  psynet rpdb

**Usage**

.. code:: bash

  psynet rpdb [OPTIONS]

  Options:
    --ip [bonus|time|both]    IP address. Default: '127.0.0.1'.
    --port                    Port. Default: '4444'.
